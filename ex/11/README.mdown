# Esercitazione 11 #

Questa esercitazione si concentra sui thread POSIX. Quando è richiesto di
generare casualmente valori è necessario usare funzioni thread safe (la
`rand()` non lo è, leggere `man rand`).

## Esercizio 1: produttore e consumatore ##

Scrivere un programma C con due thread: produttore e consumatore. Il thread
produttore genera una sequenza di numeri casuali e li inserisce in una coda
condivisa. Il thread consumatore estrae i numeri dalla coda e li stampa su
`stdout`. In particolare, il thread produttore deve eseguire un ciclo infinito
in cui genera un numero casuale `r`, lo inserisce in una lista e poi si mette
in attesa per 2 secondi (con una `sleep()`). Il thread consumatore esegure un
ciclo infinito in cui estrae gli elementi dalla coda condivisa e li stampa su
`stdout`.

_Estensione:_ fare in modo che il produttore generi un numero fissato N di
numeri casuali. Cancellare il consumatore quando il produttore ha terminato la
generazione. Stampare l'esito di entrambi.

## Esercizio 2: i filosofi a cena ##

N filosofi si incontrano a cena _da Mario_ e ordinano un piatto di spaghetti.
Notoriamente gli aspaghetti di _Mario_ sono così viscidi che possono essere
mangiati solo usando due forchette, ma ogni filosofo ne ha una sola, perciò
deve chiedere una forchetta in prestito a uno dei suoi vicini. Tipicamente ogni
filosofo è impegnato ininterrottamente in una sequenza di tre attività:
meditare (thinking), cercare di acquisire le forchette (hungry) o mangiare
(eating).

Scrivere un programma C che attivi N thread filosofi (numerati da 0 a N-1) che
eseguono il ciclo descritto. Ogni filosofo deve scrivere su `stdout` l'inizio
di ogni fase (thinking, eating, hungry) e il suo indice.

## Esercizio 3: problema dei lettori e degli scrittori ##

Si consideri una lista di interi contenente per lemento un colore fra RED,
BLUE, GREEN, WHITE, BLACK, oppure l'indicazione di nessun colore NOCOLOR. La
lista è condivisa fra 5 thread _lettori_ e 2 thread _scrittori_. Ogni thread
lettore ha un colore di riferimento fra quelli ammessi.

I thread scrittori effettuano un ciclo infinito in cui generano casualmente un
colore e lo inseriscono in lista. Ogni lettore effettua un ciclo infinito in
cui a ogni iterazione conta il numero di occorrenze del proprio colore di
riferimento nella lista e lo stampa su `stdout`.

Si richiede che più lettori possano accedere contemporaneamente alla lista per
leggerne i valori. L'esecuzione dei thread scrittori deve invece avvenire in
mutua esclusione con tutti gli altri thread. In particolare non può esserci
accesso contemporaneao alla lista da parte dei due scrittori e neppure da parte
di uno scritto e di uno (o più) thread lettori.

